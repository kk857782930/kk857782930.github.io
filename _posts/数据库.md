# 数据库

## 环境

````
sudo apt update
sudo apt install nlohmann-json3-dev
````





## 需求



### 1.显示所有数据库 

知道有什么数据库  ->  读文件   (使用 POSIX `dirent.h`)

数据库存储在 /terminal/trld/build/release/data/strategy 



### 2.显示数据库有哪些key

迭代遍历 输出

````
/*********************************************
* 函 数: tr_iterator_key
* 功 能: 返回迭代器当前键值
* 参 数: 
*       itor    - 对象地址
*       key     - 返回键
*       key_len - 返回键长度
* 返 回: 
*       成功 - 0
*       失败 - 其他
* 备 注: key返回值需要用户手动 free
*********************************************/
int tr_iterator_key(
    const void*     itor,
    char**          key,
    int*            key_len
    )
````



### 3.选择key后显示value



### 4. 读取一个新的数据库，显示对应key中的value_name + value









## TODO:

#### ✔1.输入 数据库 + key -> 生成value  ( 数据类型 + value ) 



````
Sys_user

key == sysAdmin
[INF] : [sys_user] account=[sysAdmin] name=[系统管理员] pwd=[5bafc81c40a91a388132f1e83d172b1e] active=[1] limit_code=[00000000] valid_start_date[] valid_end_date[]


key == secAdmin
[INF] : [sys_user] account=[secAdmin] name=[安全管理员] pwd=[5bafc81c40a91a388132f1e83d172b1e] active=[1] limit_code=[00000007] valid_start_date[] valid_end_date[]


key == admin
[INF] : [sys_user] account=[admin] name=[超级管理员] pwd=[c03ce6974c089626b1111d35d84003ce] active=[1] limit_code=[00000000] valid_start_date[] valid_end_date[]


key == unlockAdmin
[INF] : [sys_user] account=[unlockAdmin] name=[解锁管理员] pwd=[6ddde9019aa079e8b2f7f94d2b3c2e51] active=[1] limit_code=[00000003] valid_start_date[] valid_end_date[]
````





````
Sys_user_permit

key = hkb
[INF] : [sys_user_permit] acount[hkb] limitcode[7] rand[0] pwd[536746b77765a0007fc9561b250917d2]
key = wgq
[INF] : [sys_user_permit] acount[wgq] limitcode[4] rand[0] pwd[c23bd4f3ada721e6a8c358787430a01b]
key = sysAdmin
[INF] : [sys_user_permit] acount[sysAdmin] limitcode[0] rand[0] pwd[5bafc81c40a91a388132f1e83d172b1e]
key = admin
[INF] : [sys_user_permit] acount[admin] limitcode[0] rand[0] pwd[c03ce6974c089626b1111d35d84003ce]
key = unlockAdmin
[INF] : [sys_user_permit] acount[unlockAdmin] limitcode[3] rand[0] pwd[6ddde9019aa079e8b2f7f94d2b3c2e51]
````



















#### ✔2.输入 数据库 -> 列出key -> 选择key -> 生成value



#### ✔3.列出所有数据库 -> 选择数据库 -> 列出key -> 选择key -> 生成value



#### ✔4.图形界面



#### ✔5.数据库排序，value用十六进制输出



##### 6.读取一个新的数据库，显示对应key中的value_name + value

 举例  



## 新问题







修改： 所有get 判断前面有没有json 跳过json put  
